// Generated by CoffeeScript 1.7.1
var Hubo, clamp, lpad, rpad,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Hubo = (function(_super) {
  var _robot;

  __extends(Hubo, _super);

  _robot = Hubo;

  Hubo.DefaultCanvas = function(args) {
    var c;
    c = WebGLRobots.DefaultCanvas.apply(this, arguments);
    c.controls.target = new THREE.Vector3(0, 0, -0.45);
    return c;
  };

  function Hubo(name, ready_callback, progress_callback) {
    var load_callback;
    this.name = name;
    Hubo.__super__.constructor.call(this);
    _robot = this;
    this.motors = new Dict();
    this.JointList = ['WST', 'NKY', 'NK1', 'NK2', 'LSP', 'LSR', 'LSY', 'LEB', 'LWY', 'LWR', 'LWP', 'RSP', 'RSR', 'RSY', 'REB', 'RWY', 'RWR', 'RWP', 'LHY', 'LHR', 'LHP', 'LKN', 'LAP', 'LAR', 'RHY', 'RHR', 'RHP', 'RKN', 'RAP', 'RAR', 'RF1', 'RF2', 'RF3', 'RF4', 'RF5', 'LF1', 'LF2', 'LF3', 'LF4', 'LF5'];
    this.loadURDF("" + local_root + "drc/drchubo-urdf/drchubo-v3.urdf", load_callback = (function(_this) {
      return function() {
        var key, value, _ref;
        _ref = _this.joints;
        for (key in _ref) {
          if (!__hasProp.call(_ref, key)) continue;
          value = _ref[key];
          if (key.length === 3) {
            _this.addRegularMotor(key);
          }
        }
        _this.reset();
        return ready_callback();
      };
    })(this), progress_callback);
  }

  Hubo.prototype.addRegularMotor = function(name) {
    var motor;
    _robot = this;
    motor = {};
    motor.name = name;
    motor.lower_limit = this.joints[name].lower_limit;
    motor.upper_limit = this.joints[name].upper_limit;
    motor.default_value = 0;
    motor.offset = 0;
    motor.value = motor.default_value;
    Object.defineProperties(motor, {
      value: {
        get: function() {
          return _robot.joints[this.name].value - _robot.motors[this.name].offset;
        },
        set: function(val) {
          val = clamp(val, this);
          val = val + _robot.motors[this.name].offset;
          _robot.joints[this.name].value = val;
          return val;
        },
        enumerable: true
      }
    });
    return this.motors[name] = motor;
  };

  Hubo.prototype.addNeckMotor = function(name) {
    var motor;
    _robot = this;
    motor = {};
    motor.name = name;
    motor.lower_limit = 0;
    motor.upper_limit = 20;
    Object.defineProperties(motor, {
      value: {
        get: function() {
          return this._value;
        },
        set: function(val) {
          var pitch, roll, _ref;
          val = clamp(val, this);
          this._value = val;
          if ((_robot.motors.NK1 != null) && (_robot.motors.NK2 != null)) {
            _ref = _robot.neckKin(_robot.motors.NK1.value + 85, _robot.motors.NK2.value + 85), pitch = _ref[0], roll = _ref[1];
            _robot.joints.HNP.value = pitch * Math.PI / 180;
            return _robot.joints.HNR.value = roll * Math.PI / 180;
          }
        }
      }
    });
    motor.default_value = 10;
    motor.value = motor.default_value;
    return this.motors[name] = motor;
  };

  Hubo.prototype.addFinger = function(name) {
    var finger, fingers, hand, motor;
    _robot = this;
    motor = {};
    motor.name = name;
    motor.lower_limit = 0;
    motor.upper_limit = 1.4;
    hand = name[0] === 'L' ? 'left' : 'right';
    fingers = ['Thumb', 'Index', 'Middle', 'Ring', 'Pinky'];
    finger = fingers[name[2] - 1];
    motor.full_name = hand + finger;
    Object.defineProperties(motor, {
      value: {
        get: function() {
          return this._value;
        },
        set: function(val) {
          val = clamp(val, this);
          this._value = val;
          _robot.joints[this.full_name + 'Knuckle1'].value = val;
          _robot.joints[this.full_name + 'Knuckle2'].value = val;
          _robot.joints[this.full_name + 'Knuckle3'].value = val;
        }
      }
    });
    motor.default_value = 0.9;
    motor.value = motor.default_value;
    return this.motors[name] = motor;
  };

  Hubo.prototype.neckKin = function(val1, val2) {
    var HNP, HNR;
    HNP = -294.4 + 1.55 * val1 + 1.55 * val2;
    HNR = 0.0 - 1.3197 * val1 + 1.3197 * val2;
    return [HNP, HNR];
  };

  Hubo.prototype.reset = function() {
    return this.motors.asArray().forEach(function(e) {
      return e.value = e.default_value;
    });
  };

  Hubo.prototype.outputPoseHeader = function() {
    return 'RHY         RHR         RHP         RKP         RAP         RAR         LHY         LHR         LHP         LKP         LAP         LAR         RSP         RSR         RSY         REP         RWY         RWR         RWP         LSP         LSR         LSY         LEP         LWY         LWR         LWP         NKY         NK1         NK2         WST         RF1         RF2         RF3         RF4         RF5         LF1         LF2         LF3         LF4         LF5         ';
  };

  Hubo.prototype.outputPose = function() {
    var name, names, str, v, vstr, _i, _len;
    str = '';
    names = this.outputPoseHeader().trim().split(/\W+/);
    for (_i = 0, _len = names.length; _i < _len; _i++) {
      name = names[_i];
      if (hubo.motors[name] != null) {
        v = hubo.motors[name].value;
      } else {
        v = 0;
      }
      vstr = v.toFixed(6);
      vstr = (v >= 0 ? "+" : "") + vstr;
      vstr = rpad(vstr, 11, ' ') + ' ';
      str += vstr;
    }
    return str;
  };

  return Hubo;

})(WebGLRobots.Robot);

clamp = function(val, joint) {
  var warn;
  warn = false;
  if (val < joint.lower_limit) {
    if (warn) {
      console.warn(joint.name + ' tried to violate lower limit: ' + joint.lower_limit);
    }
    return joint.lower_limit;
  } else if (val > joint.upper_limit) {
    if (warn) {
      console.warn(joint.name + ' tried to violate upper limit: ' + joint.upper_limit);
    }
    return joint.upper_limit;
  }
  return val;
};

lpad = function(originalstr, length, strToPad) {
  while (originalstr.length < length) {
    originalstr = strToPad + originalstr;
  }
  return originalstr;
};

rpad = function(originalstr, length, strToPad) {
  while (originalstr.length < length) {
    originalstr = originalstr + strToPad;
  }
  return originalstr;
};

//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICIvZHJjL2RyY2h1Ym8uanMiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbCiAgICAiL2RyYy9kcmNodWJvLmpzLmNvZmZlZSIKICBdLAogICJuYW1lcyI6IFtdLAogICJtYXBwaW5ncyI6ICI7QUFDQSxJQUFBLHVCQUFBO0VBQUE7aVNBQUE7O0FBQUE7QUFDRSxNQUFBLE1BQUE7O0FBQUEseUJBQUEsQ0FBQTs7QUFBQSxFQUFBLE1BQUEsR0FBUyxJQUFULENBQUE7O0FBQUEsRUFDQSxJQUFDLENBQUEsYUFBRCxHQUFnQixTQUFDLElBQUQsR0FBQTtBQUNkLFFBQUEsQ0FBQTtBQUFBLElBQUEsQ0FBQSxHQUFJLFdBQVcsQ0FBQyxhQUFhLENBQUMsS0FBMUIsQ0FBZ0MsSUFBaEMsRUFBc0MsU0FBdEMsQ0FBSixDQUFBO0FBQUEsSUFDQSxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQVgsR0FBc0IsSUFBQSxLQUFLLENBQUMsT0FBTixDQUFjLENBQWQsRUFBZ0IsQ0FBaEIsRUFBa0IsQ0FBQSxJQUFsQixDQUR0QixDQUFBO0FBRUEsV0FBTyxDQUFQLENBSGM7RUFBQSxDQURoQixDQUFBOztBQUthLEVBQUEsY0FBRSxJQUFGLEVBQVEsY0FBUixFQUF3QixpQkFBeEIsR0FBQTtBQUVYLFFBQUEsYUFBQTtBQUFBLElBRlksSUFBQyxDQUFBLE9BQUEsSUFFYixDQUFBO0FBQUEsSUFBQSxvQ0FBQSxDQUFBLENBQUE7QUFBQSxJQUNBLE1BQUEsR0FBUyxJQURULENBQUE7QUFBQSxJQUdBLElBQUMsQ0FBQSxNQUFELEdBQWMsSUFBQSxJQUFBLENBQUEsQ0FIZCxDQUFBO0FBQUEsSUFLQSxJQUFDLENBQUEsU0FBRCxHQUFhLENBQUMsS0FBRCxFQUFPLEtBQVAsRUFBYSxLQUFiLEVBQW1CLEtBQW5CLEVBQXlCLEtBQXpCLEVBQStCLEtBQS9CLEVBQXFDLEtBQXJDLEVBQTJDLEtBQTNDLEVBQWlELEtBQWpELEVBQXVELEtBQXZELEVBQTZELEtBQTdELEVB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QUFBLElBQUEsR0FBTyxLQUFQLENBQUE7QUFDQSxFQUFBLElBQUcsR0FBQSxHQUFNLEtBQUssQ0FBQyxXQUFmO0FBQ0UsSUFBQSxJQUFHLElBQUg7QUFBYSxNQUFBLE9BQU8sQ0FBQyxJQUFSLENBQWEsS0FBSyxDQUFDLElBQU4sR0FBYSxpQ0FBYixHQUFpRCxLQUFLLENBQUMsV0FBcEUsQ0FBQSxDQUFiO0tBQUE7QUFDQSxXQUFPLEtBQUssQ0FBQyxXQUFiLENBRkY7R0FBQSxNQUdLLElBQUcsR0FBQSxHQUFNLEtBQUssQ0FBQyxXQUFmO0FBQ0gsSUFBQSxJQUFHLElBQUg7QUFBYSxNQUFBLE9BQU8sQ0FBQyxJQUFSLENBQWEsS0FBSyxDQUFDLElBQU4sR0FBYSxpQ0FBYixHQUFpRCxLQUFLLENBQUMsV0FBcEUsQ0FBQSxDQUFiO0tBQUE7QUFDQSxXQUFPLEtBQUssQ0FBQyxXQUFiLENBRkc7R0FKTDtBQU9BLFNBQU8sR0FBUCxDQVJNO0FBQUEsQ0FwSlIsQ0FBQTs7QUFBQSxJQStKQSxHQUFPLFNBQUMsV0FBRCxFQUFjLE1BQWQsRUFBc0IsUUFBdEIsR0FBQTtBQUNILFNBQU8sV0FBVyxDQUFDLE1BQVosR0FBcUIsTUFBNUIsR0FBQTtBQUNJLElBQUEsV0FBQSxHQUFjLFFBQUEsR0FBVyxXQUF6QixDQURKO0VBQUEsQ0FBQTtBQUVBLFNBQU8sV0FBUCxDQUhHO0FBQUEsQ0EvSlAsQ0FBQTs7QUFBQSxJQXFLQSxHQUFPLFNBQUMsV0FBRCxFQUFjLE1BQWQsRUFBc0IsUUFBdEIsR0FBQTtBQUNILFNBQU8sV0FBVyxDQUFDLE1BQVosR0FBcUIsTUFBNUIsR0FBQTtBQUNJLElBQUEsV0FBQSxHQUFjLFdBQUEsR0FBYyxRQUE1QixDQURKO0VBQUEsQ0FBQTtBQUVBLFNBQU8sV0FBUCxDQUhHO0FBQUEsQ0FyS1AsQ0FBQSIsCiAgInNvdXJjZXNDb250ZW50IjogWwogICAgIiMgQSBjdXN0b20gZXh0ZW5zaW9uIG9mIFdlYkdMUm9ib3RzLlJvYm90IGp1c3QgZm9yIEh1Ym8uXG5jbGFzcyBIdWJvIGV4dGVuZHMgV2ViR0xSb2JvdHMuUm9ib3RcbiAgX3JvYm90ID0gdGhpcyAgXG4gIEBEZWZhdWx0Q2FudmFzOiAoYXJncykgLT5cbiAgICBjID0gV2ViR0xSb2JvdHMuRGVmYXVsdENhbnZhcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG4gICAgYy5jb250cm9scy50YXJnZXQ9bmV3IFRIUkVFLlZlY3RvcjMoMCwwLC0wLjQ1KVxuICAgIHJldHVybiBjXG4gIGNvbnN0cnVjdG9yOiAoQG5hbWUsIHJlYWR5X2NhbGxiYWNrLCBwcm9ncmVzc19jYWxsYmFjaykgLT5cbiAgICAjIFNldCB0aGlzID0gbmV3IFdlYkdMUm9ib3RzLlJvYm90KClcbiAgICBzdXBlcigpXG4gICAgX3JvYm90ID0gdGhpc1xuICAgICMgTW90b3JzXG4gICAgQG1vdG9ycyA9IG5ldyBEaWN0KClcbiAgICAjIEhlbHBmdWwgUHJvcGVydGllc1xuICAgIEBKb2ludExpc3QgPSBbJ1dTVCcsJ05LWScsJ05LMScsJ05LMicsJ0xTUCcsJ0xTUicsJ0xTWScsJ0xFQicsJ0xXWScsJ0xXUicsJ0xXUCcsJ1JTUCcsJ1JTUicsJ1JTWScsJ1JFQicsJ1JXWScsJ1JXUicsJ1JXUCcsJ0xIWScsJ0xIUicsJ0xIUCcsJ0xLTicsJ0xBUCcsJ0xBUicsJ1JIWScsJ1JIUicsJ1JIUCcsJ1JLTicsJ1JBUCcsJ1JBUicsJ1JGMScsJ1JGMicsJ1JGMycsJ1JGNCcsJ1JGNScsJ0xGMScsJ0xGMicsJ0xGMycsJ0xGNCcsJ0xGNSddXG4gICAgIyBMb2FkIHRoZSByb2JvdCB1c2luZyB0aGUgVVJERiBpbXBvcnRlci5cbiAgICBAbG9hZFVSREYoXG4gICAgICBcIiN7bG9jYWxfcm9vdH1kcmMvZHJjaHViby11cmRmL2RyY2h1Ym8tdjMudXJkZlwiLFxuICAgICAgbG9hZF9jYWxsYmFjayA9ICgpID0+XG4gICAgICAgICMgT25jZSB0aGUgVVJERiBpcyBjb21wbGV0ZWx5IGxvYWRlZCwgdGhpcyBmdW5jdGlvbiBpcyBydW4uXG4gICAgICAgIGZvciBvd24ga2V5LCB2YWx1ZSBvZiBAam9pbnRzXG4gICAgICAgICAgaWYga2V5Lmxlbmd0aCA9PSAzXG4gICAgICAgICAgICBAYWRkUmVndWxhck1vdG9yKGtleSk7XG4gICAgICAgICMgTm90ZTogb2Zmc2V0cyBub3QgbmVlZGVkIGZvciBEUkMtSHVib1xuICAgICAgICAjICMgT2Zmc2V0cyBmb3Igc2hvdWxkZXIgcm9sbCBhbmQgZWxib3cgcGl0Y2ggKHZhbHVlcyB0YWtlbiBmcm9tIGh1Ym9wbHVzLmtpbmJvZHkueG1sIFwiPGluaXRpYWw+XCIgZmllbGRzKVxuICAgICAgICAjIF9yb2JvdC5tb3RvcnMuTFNSLm9mZnNldCA9ICsxNS8xODAqTWF0aC5QSVxuICAgICAgICAjIF9yb2JvdC5tb3RvcnMuUlNSLm9mZnNldCA9IC0xNS8xODAqTWF0aC5QSVxuICAgICAgICAjIF9yb2JvdC5tb3RvcnMuTEVCLm9mZnNldCA9IC0xMC8xODAqTWF0aC5QSVxuICAgICAgICAjIF9yb2JvdC5tb3RvcnMuUkVCLm9mZnNldCA9IC0xMC8xODAqTWF0aC5QSVxuICAgICAgICAjIEBhZGRGaW5nZXIoJ0xGMScpXG4gICAgICAgICMgQGFkZEZpbmdlcignTEYyJylcbiAgICAgICAgIyBAYWRkRmluZ2VyKCdMRjMnKVxuICAgICAgICAjIEBhZGRGaW5nZXIoJ0xGNCcpXG4gICAgICAgICMgQGFkZEZpbmdlcignTEY1JylcbiAgICAgICAgIyBAYWRkRmluZ2VyKCdSRjEnKVxuICAgICAgICAjIEBhZGRGaW5nZXIoJ1JGMicpXG4gICAgICAgICMgQGFkZEZpbmdlcignUkYzJylcbiAgICAgICAgIyBAYWRkRmluZ2VyKCdSRjQnKVxuICAgICAgICAjIEBhZGRGaW5nZXIoJ1JGNScpICAgICAgXG4gICAgICAgICMgQGFkZE5lY2tNb3RvcignTksxJylcbiAgICAgICAgIyBAYWRkTmVja01vdG9yKCdOSzInKVxuICAgICAgICBAcmVzZXQoKVxuICAgICAgICAjIEFkZCB5b3VyIHJvYm90IHRvIHRoZSBjYW52YXMuXG4gICAgICAgIHJlYWR5X2NhbGxiYWNrKClcbiAgICAgIHByb2dyZXNzX2NhbGxiYWNrXG4gICAgKVxuICBhZGRSZWd1bGFyTW90b3I6IChuYW1lKSAtPlxuICAgIF9yb2JvdCA9IHRoaXNcbiAgICBtb3RvciA9IHt9XG4gICAgbW90b3IubmFtZSA9IG5hbWVcbiAgICBtb3Rvci5sb3dlcl9saW1pdCA9IEBqb2ludHNbbmFtZV0ubG93ZXJfbGltaXRcbiAgICBtb3Rvci51cHBlcl9saW1pdCA9IEBqb2ludHNbbmFtZV0udXBwZXJfbGltaXRcbiAgICBtb3Rvci5kZWZhdWx0X3ZhbHVlID0gMFxuICAgIG1vdG9yLm9mZnNldCA9IDBcbiAgICBtb3Rvci52YWx1ZSA9IG1vdG9yLmRlZmF1bHRfdmFsdWVcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyBtb3RvcixcbiAgICB2YWx1ZTpcbiAgICAgIGdldDogLT4gcmV0dXJuIF9yb2JvdC5qb2ludHNbQG5hbWVdLnZhbHVlIC0gX3JvYm90Lm1vdG9yc1tAbmFtZV0ub2Zmc2V0XG4gICAgICBzZXQ6ICh2YWwpIC0+IFxuICAgICAgICB2YWwgPSBjbGFtcCh2YWwsdGhpcylcbiAgICAgICAgdmFsID0gdmFsICsgX3JvYm90Lm1vdG9yc1tAbmFtZV0ub2Zmc2V0XG4gICAgICAgIF9yb2JvdC5qb2ludHNbQG5hbWVdLnZhbHVlID0gdmFsXG4gICAgICAgIHJldHVybiB2YWxcbiAgICAgIGVudW1lcmFibGU6IHRydWVcbiAgICBAbW90b3JzW25hbWVdID0gbW90b3JcbiAgYWRkTmVja01vdG9yOiAobmFtZSkgLT5cbiAgICBfcm9ib3QgPSB0aGlzXG4gICAgIyBDcmVhdGUgdGhlIG5lY2sgbW90b3JzLlxuICAgIG1vdG9yID0ge31cbiAgICBtb3Rvci5uYW1lID0gbmFtZSAjIEVpdGhlciBOSzEgb3IgTksyXG4gICAgbW90b3IubG93ZXJfbGltaXQgPSAwICMgbW0sIE5vdGU6IGxpbmVhciBhY3R1YXRvciBwaXRjaCBpcyAxbW0vcmV2LCAxMjggZW5jb2RlciBjb3VudHMgcGVyIHJldi5cbiAgICBtb3Rvci51cHBlcl9saW1pdCA9IDIwICMgbW1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyBtb3RvcixcbiAgICAgIHZhbHVlOlxuICAgICAgICBnZXQ6IC0+IHJldHVybiBAX3ZhbHVlXG4gICAgICAgIHNldDogKHZhbCkgLT5cbiAgICAgICAgICB2YWwgPSBjbGFtcCh2YWwsdGhpcylcbiAgICAgICAgICBAX3ZhbHVlID0gdmFsXG4gICAgICAgICAgIyBXZSBuZWVkIGJvdGggbmVjayBtb3RvcnMgdG8gY2FsY3VsYXRlIHRoZSBoZWFkIHBvc2VcbiAgICAgICAgICBpZiBfcm9ib3QubW90b3JzLk5LMT8gYW5kIF9yb2JvdC5tb3RvcnMuTksyP1xuICAgICAgICAgICAgIyBXZSBhZGQgODVtbSB0byB0aGUgZXh0ZW5zaW9uIG9mIHRoZSBsaW5lYXIgYWN0dWF0b3IgdG8gZ2V0IHRoZSB0b3RhbCBsaW5rIGxlbmd0aFxuICAgICAgICAgICAgW3BpdGNoLCByb2xsXSA9IF9yb2JvdC5uZWNrS2luKF9yb2JvdC5tb3RvcnMuTksxLnZhbHVlKzg1LCBfcm9ib3QubW90b3JzLk5LMi52YWx1ZSs4NSlcbiAgICAgICAgICAgIF9yb2JvdC5qb2ludHMuSE5QLnZhbHVlID0gcGl0Y2gqTWF0aC5QSS8xODBcbiAgICAgICAgICAgIF9yb2JvdC5qb2ludHMuSE5SLnZhbHVlID0gcm9sbCpNYXRoLlBJLzE4MFxuICAgIG1vdG9yLmRlZmF1bHRfdmFsdWUgPSAxMCAjbW1cbiAgICBtb3Rvci52YWx1ZSA9IG1vdG9yLmRlZmF1bHRfdmFsdWVcbiAgICBAbW90b3JzW25hbWVdID0gbW90b3JcbiAgYWRkRmluZ2VyOiAobmFtZSkgLT5cbiAgICBfcm9ib3QgPSB0aGlzXG4gICAgIyBBZGQgZmluZ2VyIG1vdG9yXG4gICAgbW90b3IgPSB7fVxuICAgIG1vdG9yLm5hbWUgPSBuYW1lXG4gICAgbW90b3IubG93ZXJfbGltaXQgPSAwXG4gICAgbW90b3IudXBwZXJfbGltaXQgPSAxLjRcbiAgICAjIE5vdGU6IHdlIGFyZSBWRVJZIE1VQ0ggZXhwZWN0aW5nIGEgVExBIGZvciAnbmFtZSdcbiAgICBoYW5kID0gaWYgKG5hbWVbMF09PSdMJykgdGhlbiAnbGVmdCcgZWxzZSAncmlnaHQnXG4gICAgZmluZ2VycyA9IFsnVGh1bWInLCAnSW5kZXgnLCAnTWlkZGxlJywgJ1JpbmcnLCAnUGlua3knXVxuICAgIGZpbmdlciA9IGZpbmdlcnNbbmFtZVsyXS0xXVxuICAgIG1vdG9yLmZ1bGxfbmFtZSA9IGhhbmQgKyBmaW5nZXJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyBtb3RvcixcbiAgICAgIHZhbHVlOlxuICAgICAgICBnZXQ6IC0+IHJldHVybiBAX3ZhbHVlXG4gICAgICAgIHNldDogKHZhbCkgLT4gXG4gICAgICAgICAgdmFsID0gY2xhbXAodmFsLHRoaXMpXG4gICAgICAgICAgQF92YWx1ZSA9IHZhbCAgICAgICAgICAgICAgXG4gICAgICAgICAgX3JvYm90LmpvaW50c1tAZnVsbF9uYW1lICsgJ0tudWNrbGUxJ10udmFsdWUgPSB2YWxcbiAgICAgICAgICBfcm9ib3Quam9pbnRzW0BmdWxsX25hbWUgKyAnS251Y2tsZTInXS52YWx1ZSA9IHZhbFxuICAgICAgICAgIF9yb2JvdC5qb2ludHNbQGZ1bGxfbmFtZSArICdLbnVja2xlMyddLnZhbHVlID0gdmFsXG4gICAgICAgICAgcmV0dXJuXG4gICAgbW90b3IuZGVmYXVsdF92YWx1ZSA9IDAuOSAjIHN0YXJ0IHdpdGggZmluZ2VycyBoYWxmIGN1cmxlZFxuICAgIG1vdG9yLnZhbHVlID0gbW90b3IuZGVmYXVsdF92YWx1ZVxuICAgICMgQWRkIHRvIG1vdG9yIGNvbGxlY3Rpb25cbiAgICBAbW90b3JzW25hbWVdID0gbW90b3JcbiAgIyBBVFRFTlRJT046IFRoaXMgcmV0dXJucyB2YWx1ZXMgaW4gZGVncmVlcy5cbiAgbmVja0tpbjogKHZhbDEsIHZhbDIpIC0+XG4gICAgIyBUaGUgY29kZSB1c2VkIHRvIGRlcml2ZSB0aGVzZSBlcXVhdGlvbnMgY2FuIGJlIGZvdW5kIGluIHRoZSAnbmVja19raW4nIGJyYW5jaC4gXG4gICAgIyBTaG9ydCBFeHBsYW5hdGlvbjogVGhlIG5lY2sgZm9yd2FyZCBraW5lbWF0aWNzIGhhcyBubyBzdHJhaWdodGZvcndhcmQgYW5hbHl0aWNhbCBzb2x1dGlvbi4gSW5zdGVhZCwgaXQgd2FzIHNvbHZlZCBudW1lcmljYWxseSBieVxuICAgICMgZml4aW5nIHRoZSBoZWFkIHBpdGNoIGFuZCByb2xsLCBhbmQgdGhlbiBmaW5kaW5nIHRoZSBsZW5ndGhzIG9mIHRoZSBsaW5lYXIgYWN0dWF0b3JzLiAoRXNzZW50aWFsbHksIHRoZSBpbnZlcnNlIGtpbmVtYXRpY3MgYXJlIFxuICAgICMgZWFzaWVyIHRvIHNvbHZlLikgVXNpbmcgdGhpcywgYSBiaWcgbG9va3VwIHRhYmxlIHdhcyBjYWxjdWxhdGVkLiBXaGVuIHBsb3R0ZWQsIHRoZSBwaXRjaCBhbmQgcm9sbCBmdW5jdGlvbnMgY2FuIGJlIHNlZW4gdG8gYmUgXG4gICAgIyBub24tbGluZWFyIGJ1dCB0aGV5IGFyZSBuZWFybHkgcGxhbmFyIDJEIGZ1bmN0aW9ucy4gVGhlIGVxdWF0aW9ucyB1c2VkIGJlbG93IGFyZSB0aGUgbGluZWFyIGJlc3QgZml0IG9mIHRoZSBudW1lcmljYWwgbG9va3VwIHRhYmxlcy5cbiAgICAjIEl0IHNob3VsZG4ndCBiZSBvZmYgYnkgbW9yZSB0aGFuIGEgY291cGxlIGRlZ3JlZXMgYXQgd29yc3QuICAgIFxuICAgIEhOUCA9IC0yOTQuNCArIDEuNTUqdmFsMSArIDEuNTUqdmFsMlxuICAgIEhOUiA9ICAgIDAuMCAtIDEuMzE5Nyp2YWwxICsgMS4zMTk3KnZhbDJcbiAgICByZXR1cm4gW0hOUCwgSE5SXVxuICByZXNldDogKCkgLT5cbiAgICBAbW90b3JzLmFzQXJyYXkoKS5mb3JFYWNoIChlKSAtPlxuICAgICAgZS52YWx1ZSA9IGUuZGVmYXVsdF92YWx1ZVxuICBvdXRwdXRQb3NlSGVhZGVyOiAoKSAtPlxuICAgIHJldHVybiAnUkhZICAgICAgICAgUkhSICAgICAgICAgUkhQICAgICAgICAgUktQICAgICAgICAgUkFQICAgICAgICAgUkFSICAgICAgICAgTEhZICAgICAgICAgTEhSICAgICAgICAgTEhQICAgICAgICAgTEtQICAgICAgICAgTEFQICAgICAgICAgTEFSICAgICAgICAgUlNQICAgICAgICAgUlNSICAgICAgICAgUlNZICAgICAgICAgUkVQICAgICAgICAgUldZICAgICAgICAgUldSICAgICAgICAgUldQICAgICAgICAgTFNQICAgICAgICAgTFNSICAgICAgICAgTFNZICAgICAgICAgTEVQICAgICAgICAgTFdZICAgICAgICAgTFdSICAgICAgICAgTFdQICAgICAgICAgTktZICAgICAgICAgTksxICAgICAgICAgTksyICAgICAgICAgV1NUICAgICAgICAgUkYxICAgICAgICAgUkYyICAgICAgICAgUkYzICAgICAgICAgUkY0ICAgICAgICAgUkY1ICAgICAgICAgTEYxICAgICAgICAgTEYyICAgICAgICAgTEYzICAgICAgICAgTEY0ICAgICAgICAgTEY1ICAgICAgICAgJ1xuICBvdXRwdXRQb3NlOiAoKSAtPlxuICAgIHN0ciA9ICcnXG4gICAgbmFtZXMgPSBAb3V0cHV0UG9zZUhlYWRlcigpLnRyaW0oKS5zcGxpdCggL1xcVysvIClcbiAgICBmb3IgbmFtZSBpbiBuYW1lc1xuICAgICAgaWYgaHViby5tb3RvcnNbbmFtZV0/ICAgICAgICBcbiAgICAgICAgdiA9IGh1Ym8ubW90b3JzW25hbWVdLnZhbHVlXG4gICAgICBlbHNlXG4gICAgICAgICMgV2UgbmVlZCB0byBzdXBwb3J0IGlnbm9yaW5nIGNvbHVtbnMgKHdyaXN0IHJvbGwsIHNwZWNpZmljYWxseSkgaW4gb3JkZXIgdG8gYmUgY29tcGF0aWJsZSBcbiAgICAgICAgIyB3aXRoIGh1Ym8tcmVhZC10cmFqZWN0b3J5XG4gICAgICAgIHYgPSAwICAgICAgIFxuICAgICAgdnN0ciA9IHYudG9GaXhlZCg2KVxuICAgICAgdnN0ciA9IChpZiB2Pj0wIHRoZW4gXCIrXCIgZWxzZSBcIlwiKSArIHZzdHJcbiAgICAgICMgaWYgdiA+PSAwIFxuICAgICAgIyAgIHZzdHIgPSBcIitcIiArIHZzdHJcbiAgICAgICMgZWxzZVxuICAgICAgIyAgIHZzdHIgPSBcIi1cIiArIHZzdHJcbiAgICAgIHZzdHIgPSBycGFkKHZzdHIsMTEsJyAnKSArICcgJ1xuICAgICAgc3RyICs9IHZzdHJcbiAgICByZXR1cm4gc3RyXG5cbmNsYW1wID0gKHZhbCxqb2ludCkgLT5cbiAgd2FybiA9IG9mZlxuICBpZiB2YWwgPCBqb2ludC5sb3dlcl9saW1pdFxuICAgIGlmIHdhcm4gdGhlbiBjb25zb2xlLndhcm4gam9pbnQubmFtZSArICcgdHJpZWQgdG8gdmlvbGF0ZSBsb3dlciBsaW1pdDogJyArIGpvaW50Lmxvd2VyX2xpbWl0XG4gICAgcmV0dXJuIGpvaW50Lmxvd2VyX2xpbWl0XG4gIGVsc2UgaWYgdmFsID4gam9pbnQudXBwZXJfbGltaXRcbiAgICBpZiB3YXJuIHRoZW4gY29uc29sZS53YXJuIGpvaW50Lm5hbWUgKyAnIHRyaWVkIHRvIHZpb2xhdGUgdXBwZXIgbGltaXQ6ICcgKyBqb2ludC51cHBlcl9saW1pdFxuICAgIHJldHVybiBqb2ludC51cHBlcl9saW1pdFxuICByZXR1cm4gdmFsXG5cblxubHBhZCA9IChvcmlnaW5hbHN0ciwgbGVuZ3RoLCBzdHJUb1BhZCkgLT5cbiAgICB3aGlsZSAob3JpZ2luYWxzdHIubGVuZ3RoIDwgbGVuZ3RoKVxuICAgICAgICBvcmlnaW5hbHN0ciA9IHN0clRvUGFkICsgb3JpZ2luYWxzdHJcbiAgICByZXR1cm4gb3JpZ2luYWxzdHJcblxuIFxucnBhZCA9IChvcmlnaW5hbHN0ciwgbGVuZ3RoLCBzdHJUb1BhZCkgLT5cbiAgICB3aGlsZSAob3JpZ2luYWxzdHIubGVuZ3RoIDwgbGVuZ3RoKVxuICAgICAgICBvcmlnaW5hbHN0ciA9IG9yaWdpbmFsc3RyICsgc3RyVG9QYWRcbiAgICByZXR1cm4gb3JpZ2luYWxzdHJcbiIKICBdCn0=