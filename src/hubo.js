// Generated by CoffeeScript 1.7.1
var Hubo, clamp, lpad, rpad,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Hubo = (function(_super) {
  var _robot;

  __extends(Hubo, _super);

  _robot = Hubo;

  Hubo.DefaultCanvas = function(args) {
    var c;
    c = WebGLRobots.DefaultCanvas.apply(this, arguments);
    c.controls.target = new THREE.Vector3(0, 0, -0.3);
    return c;
  };

  function Hubo(name, ready_callback, progress_callback) {
    var load_callback;
    this.name = name;
    Hubo.__super__.constructor.call(this);
    _robot = this;
    this.motors = new Dict();
    this.loadURDF("" + local_root + "data/hubo-urdf/model.urdf", load_callback = (function(_this) {
      return function() {
        var key, value, _ref;
        _ref = _this.joints;
        for (key in _ref) {
          if (!__hasProp.call(_ref, key)) continue;
          value = _ref[key];
          if (key.length === 3) {
            _this.addRegularMotor(key);
          }
        }
        _robot.motors.LSR.offset = +15 / 180 * Math.PI;
        _robot.motors.RSR.offset = -15 / 180 * Math.PI;
        _robot.motors.LEB.offset = -10 / 180 * Math.PI;
        _robot.motors.REB.offset = -10 / 180 * Math.PI;
        _this.addFinger('LF1');
        _this.addFinger('LF2');
        _this.addFinger('LF3');
        _this.addFinger('LF4');
        _this.addFinger('LF5');
        _this.addFinger('RF1');
        _this.addFinger('RF2');
        _this.addFinger('RF3');
        _this.addFinger('RF4');
        _this.addFinger('RF5');
        _this.addNeckMotor('NK1');
        _this.addNeckMotor('NK2');
        _this.reset();
        return ready_callback();
      };
    })(this), progress_callback);
  }

  Hubo.prototype.addRegularMotor = function(name) {
    var motor;
    _robot = this;
    motor = {};
    motor.name = name;
    motor.lower_limit = this.joints[name].lower_limit;
    motor.upper_limit = this.joints[name].upper_limit;
    motor.default_value = 0;
    motor.offset = 0;
    motor.value = motor.default_value;
    Object.defineProperties(motor, {
      value: {
        get: function() {
          return _robot.joints[this.name].value - _robot.motors[this.name].offset;
        },
        set: function(val) {
          val = clamp(val, this);
          val = val + _robot.motors[this.name].offset;
          _robot.joints[this.name].value = val;
          return val;
        },
        enumerable: true
      }
    });
    return this.motors[name] = motor;
  };

  Hubo.prototype.addNeckMotor = function(name) {
    var motor;
    _robot = this;
    motor = {};
    motor.name = name;
    motor.lower_limit = -10;
    motor.upper_limit = 10;
    Object.defineProperties(motor, {
      value: {
        get: function() {
          switch (name) {
            case 'NK1':
              return this._value = _robot.getNK1();
            case 'NK2':
              return this._value = _robot.getNK2();
          }
        },
        set: function(val) {
          val = clamp(val, this);
          this._value = val;
          _robot.motors.HNP.value = _robot.getHNP();
          return _robot.motors.HNR.value = _robot.getHNR();
        }
      }
    });
    motor.default_value = 0;
    motor._value = motor.default_value;
    return this.motors[name] = motor;
  };

  Hubo.prototype.addFinger = function(name) {
    var finger, fingers, hand, motor;
    _robot = this;
    motor = {};
    motor.name = name;
    motor.lower_limit = -1;
    motor.upper_limit = 1;
    hand = name[0] === 'L' ? 'left' : 'right';
    fingers = ['Thumb', 'Index', 'Middle', 'Ring', 'Pinky'];
    finger = fingers[name[2] - 1];
    motor.full_name = hand + finger;
    Object.defineProperties(motor, {
      value: {
        get: function() {
          return this._value;
        },
        set: function(val) {
          val = clamp(val, this);
          this._value = val;
          val = (-val + 1) / 2 * 1.4;
          _robot.joints[this.full_name + 'Knuckle1'].value = val;
          _robot.joints[this.full_name + 'Knuckle2'].value = val;
          _robot.joints[this.full_name + 'Knuckle3'].value = val;
        }
      }
    });
    motor.default_value = 0.9;
    motor.value = motor.default_value;
    return this.motors[name] = motor;
  };

  Hubo.prototype.getNK1 = function() {
    var HNP, HNR;
    HNP = _robot.motors.HNP.value;
    HNR = _robot.motors.HNR.value;
    return 180 / Math.PI * (0.322581 * HNP - 0.378874 * HNR);
  };

  Hubo.prototype.getNK2 = function() {
    var HNP, HNR;
    HNP = _robot.motors.HNP.value;
    HNR = _robot.motors.HNR.value;
    return 180 / Math.PI * (0.322581 * HNP + 0.378874 * HNR);
  };

  Hubo.prototype.getHNP = function() {
    var NK1, NK2;
    NK1 = _robot.motors.NK1._value;
    NK2 = _robot.motors.NK2._value;
    return Math.PI / 180 * (1.55 * NK1 + 1.55 * NK2);
  };

  Hubo.prototype.getHNR = function() {
    var NK1, NK2;
    NK1 = _robot.motors.NK1._value;
    NK2 = _robot.motors.NK2._value;
    return Math.PI / 180 * (-1.3197 * NK1 + 1.3197 * NK2);
  };

  Hubo.prototype.reset = function() {
    return this.motors.asArray().forEach(function(e) {
      return e.value = e.default_value;
    });
  };

  Hubo.prototype.outputPoseHeader = function() {
    return 'RHY         RHR         RHP         RKN         RAP         RAR         LHY         LHR         LHP         LKN         LAP         LAR         RSP         RSR         RSY         REB         RWY         RWR         RWP         LSP         LSR         LSY         LEB         LWY         LWR         LWP         NKY         NK1         NK2         WST         RF1         RF2         RF3         RF4         RF5         LF1         LF2         LF3         LF4         LF5         ';
  };

  Hubo.prototype.outputPose = function() {
    var name, names, str, v, vstr, _i, _len;
    str = '';
    names = this.outputPoseHeader().trim().split(/\W+/);
    for (_i = 0, _len = names.length; _i < _len; _i++) {
      name = names[_i];
      if (hubo.motors[name] != null) {
        v = hubo.motors[name].value;
      } else {
        v = 0;
      }
      vstr = v.toFixed(6);
      vstr = (v >= 0 ? "+" : "") + vstr;
      vstr = rpad(vstr, 11, ' ') + ' ';
      str += vstr;
    }
    return str;
  };

  return Hubo;

})(WebGLRobots.Robot);

clamp = function(val, joint) {
  var warn;
  warn = false;
  if (val < joint.lower_limit) {
    if (warn) {
      console.warn(joint.name + ' tried to violate lower limit: ' + joint.lower_limit);
    }
    return joint.lower_limit;
  } else if (val > joint.upper_limit) {
    if (warn) {
      console.warn(joint.name + ' tried to violate upper limit: ' + joint.upper_limit);
    }
    return joint.upper_limit;
  }
  return val;
};

lpad = function(originalstr, length, strToPad) {
  while (originalstr.length < length) {
    originalstr = strToPad + originalstr;
  }
  return originalstr;
};

rpad = function(originalstr, length, strToPad) {
  while (originalstr.length < length) {
    originalstr = originalstr + strToPad;
  }
  return originalstr;
};

//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICIvc3JjL2h1Ym8uanMiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbCiAgICAiL3NyYy9odWJvLmpzLmNvZmZlZSIKICBdLAogICJuYW1lcyI6IFtdLAogICJtYXBwaW5ncyI6ICI7QUFDQSxJQUFBLHVCQUFBO0VBQUE7aVNBQUE7O0FBQUE7QUFDRSxNQUFBLE1BQUE7O0FBQUEseUJBQUEsQ0FBQTs7QUFBQSxFQUFBLE1BQUEsR0FBUyxJQUFULENBQUE7O0FBQUEsRUFDQSxJQUFDLENBQUEsYUFBRCxHQUFnQixTQUFDLElBQUQsR0FBQTtBQUNkLFFBQUEsQ0FBQTtBQUFBLElBQUEsQ0FBQSxHQUFJLFdBQVcsQ0FBQyxhQUFhLENBQUMsS0FBMUIsQ0FBZ0MsSUFBaEMsRUFBc0MsU0FBdEMsQ0FBSixDQUFBO0FBQUEsSUFDQSxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQVgsR0FBd0IsSUFBQSxLQUFLLENBQUMsT0FBTixDQUFjLENBQWQsRUFBZ0IsQ0FBaEIsRUFBa0IsQ0FBQSxHQUFsQixDQUR4QixDQUFBO0FBRUEsV0FBTyxDQUFQLENBSGM7RUFBQSxDQURoQixDQUFBOztBQUthLEVBQUEsY0FBRSxJQUFGLEVBQVEsY0FBUixFQUF3QixpQkFBeEIsR0FBQTtBQUVYLFFBQUEsYUFBQTtBQUFBLElBRlksSUFBQyxDQUFBLE9BQUEsSUFFYixDQUFBO0FBQUEsSUFBQSxvQ0FBQSxDQUFBLENBQUE7QUFBQSxJQUNBLE1BQUEsR0FBUyxJQURULENBQUE7QUFBQSxJQUdBLElBQUMsQ0FBQSxNQUFELEdBQWMsSUFBQSxJQUFBLENBQUEsQ0FIZCxDQUFBO0FBQUEsSUFLQSxJQUFDLENBQUEsUUFBRCxDQUNFLEVBQUEsR0FBRSxVQUFGLEdBQWMsMkJBRGhCLEVBRUUsYUFBQSxHQUFnQixDQUFBLFNBQUEsS0FBQSxHQUFBO2FBQUEsU0FBQSxHQUFBO0FBRWQsWUFBQSxnQkFBQTtBQUFBO0FBQUEsYUFBQSxXQUFBOzs0QkFBQTtBQUNFLFVBQUEsSUFB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QUFBLEdBQWMsUUFBQSxHQUFXLFdBQXpCLENBREo7RUFBQSxDQUFBO0FBRUEsU0FBTyxXQUFQLENBSEc7QUFBQSxDQXpLUCxDQUFBOztBQUFBLElBK0tBLEdBQU8sU0FBQyxXQUFELEVBQWMsTUFBZCxFQUFzQixRQUF0QixHQUFBO0FBQ0gsU0FBTyxXQUFXLENBQUMsTUFBWixHQUFxQixNQUE1QixHQUFBO0FBQ0ksSUFBQSxXQUFBLEdBQWMsV0FBQSxHQUFjLFFBQTVCLENBREo7RUFBQSxDQUFBO0FBRUEsU0FBTyxXQUFQLENBSEc7QUFBQSxDQS9LUCxDQUFBIiwKICAic291cmNlc0NvbnRlbnQiOiBbCiAgICAiIyBBIGN1c3RvbSBleHRlbnNpb24gb2YgV2ViR0xSb2JvdHMuUm9ib3QganVzdCBmb3IgSHViby5cbmNsYXNzIEh1Ym8gZXh0ZW5kcyBXZWJHTFJvYm90cy5Sb2JvdFxuICBfcm9ib3QgPSB0aGlzICBcbiAgQERlZmF1bHRDYW52YXM6IChhcmdzKSAtPlxuICAgIGMgPSBXZWJHTFJvYm90cy5EZWZhdWx0Q2FudmFzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcbiAgICBjLmNvbnRyb2xzLnRhcmdldCA9IG5ldyBUSFJFRS5WZWN0b3IzKDAsMCwtMC4zKTtcbiAgICByZXR1cm4gY1xuICBjb25zdHJ1Y3RvcjogKEBuYW1lLCByZWFkeV9jYWxsYmFjaywgcHJvZ3Jlc3NfY2FsbGJhY2spIC0+XG4gICAgIyBTZXQgdGhpcyA9IG5ldyBXZWJHTFJvYm90cy5Sb2JvdCgpXG4gICAgc3VwZXIoKVxuICAgIF9yb2JvdCA9IHRoaXNcbiAgICAjIE1vdG9yc1xuICAgIEBtb3RvcnMgPSBuZXcgRGljdCgpXG4gICAgIyBMb2FkIHRoZSByb2JvdCB1c2luZyB0aGUgVVJERiBpbXBvcnRlci5cbiAgICBAbG9hZFVSREYoXG4gICAgICBcIiN7bG9jYWxfcm9vdH1kYXRhL2h1Ym8tdXJkZi9tb2RlbC51cmRmXCIsXG4gICAgICBsb2FkX2NhbGxiYWNrID0gKCkgPT5cbiAgICAgICAgIyBPbmNlIHRoZSBVUkRGIGlzIGNvbXBsZXRlbHkgbG9hZGVkLCB0aGlzIGZ1bmN0aW9uIGlzIHJ1bi5cbiAgICAgICAgZm9yIG93biBrZXksIHZhbHVlIG9mIEBqb2ludHNcbiAgICAgICAgICBpZiBrZXkubGVuZ3RoID09IDNcbiAgICAgICAgICAgIEBhZGRSZWd1bGFyTW90b3Ioa2V5KTtcbiAgICAgICAgIyBPZmZzZXRzIGZvciBzaG91bGRlciByb2xsIGFuZCBlbGJvdyBwaXRjaCAodmFsdWVzIHRha2VuIGZyb20gaHVib3BsdXMua2luYm9keS54bWwgXCI8aW5pdGlhbD5cIiBmaWVsZHMpXG4gICAgICAgIF9yb2JvdC5tb3RvcnMuTFNSLm9mZnNldCA9ICsxNS8xODAqTWF0aC5QSVxuICAgICAgICBfcm9ib3QubW90b3JzLlJTUi5vZmZzZXQgPSAtMTUvMTgwKk1hdGguUElcbiAgICAgICAgX3JvYm90Lm1vdG9ycy5MRUIub2Zmc2V0ID0gLTEwLzE4MCpNYXRoLlBJXG4gICAgICAgIF9yb2JvdC5tb3RvcnMuUkVCLm9mZnNldCA9IC0xMC8xODAqTWF0aC5QSVxuICAgICAgICBAYWRkRmluZ2VyKCdMRjEnKVxuICAgICAgICBAYWRkRmluZ2VyKCdMRjInKVxuICAgICAgICBAYWRkRmluZ2VyKCdMRjMnKVxuICAgICAgICBAYWRkRmluZ2VyKCdMRjQnKVxuICAgICAgICBAYWRkRmluZ2VyKCdMRjUnKVxuICAgICAgICBAYWRkRmluZ2VyKCdSRjEnKVxuICAgICAgICBAYWRkRmluZ2VyKCdSRjInKVxuICAgICAgICBAYWRkRmluZ2VyKCdSRjMnKVxuICAgICAgICBAYWRkRmluZ2VyKCdSRjQnKVxuICAgICAgICBAYWRkRmluZ2VyKCdSRjUnKSAgICAgIFxuICAgICAgICBAYWRkTmVja01vdG9yKCdOSzEnKVxuICAgICAgICBAYWRkTmVja01vdG9yKCdOSzInKVxuICAgICAgICBAcmVzZXQoKVxuICAgICAgICAjIEFkZCB5b3VyIHJvYm90IHRvIHRoZSBjYW52YXMuXG4gICAgICAgIHJlYWR5X2NhbGxiYWNrKClcbiAgICAgIHByb2dyZXNzX2NhbGxiYWNrXG4gICAgKVxuICBhZGRSZWd1bGFyTW90b3I6IChuYW1lKSAtPlxuICAgIF9yb2JvdCA9IHRoaXNcbiAgICBtb3RvciA9IHt9XG4gICAgbW90b3IubmFtZSA9IG5hbWVcbiAgICBtb3Rvci5sb3dlcl9saW1pdCA9IEBqb2ludHNbbmFtZV0ubG93ZXJfbGltaXRcbiAgICBtb3Rvci51cHBlcl9saW1pdCA9IEBqb2ludHNbbmFtZV0udXBwZXJfbGltaXRcbiAgICBtb3Rvci5kZWZhdWx0X3ZhbHVlID0gMFxuICAgIG1vdG9yLm9mZnNldCA9IDBcbiAgICBtb3Rvci52YWx1ZSA9IG1vdG9yLmRlZmF1bHRfdmFsdWVcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyBtb3RvcixcbiAgICB2YWx1ZTpcbiAgICAgIGdldDogLT4gcmV0dXJuIF9yb2JvdC5qb2ludHNbQG5hbWVdLnZhbHVlIC0gX3JvYm90Lm1vdG9yc1tAbmFtZV0ub2Zmc2V0XG4gICAgICBzZXQ6ICh2YWwpIC0+IFxuICAgICAgICB2YWwgPSBjbGFtcCh2YWwsdGhpcylcbiAgICAgICAgdmFsID0gdmFsICsgX3JvYm90Lm1vdG9yc1tAbmFtZV0ub2Zmc2V0XG4gICAgICAgIF9yb2JvdC5qb2ludHNbQG5hbWVdLnZhbHVlID0gdmFsXG4gICAgICAgIHJldHVybiB2YWxcbiAgICAgIGVudW1lcmFibGU6IHRydWVcbiAgICBAbW90b3JzW25hbWVdID0gbW90b3JcbiAgYWRkTmVja01vdG9yOiAobmFtZSkgLT5cbiAgICBfcm9ib3QgPSB0aGlzXG4gICAgIyBDcmVhdGUgdGhlIG5lY2sgbW90b3JzLlxuICAgIG1vdG9yID0ge31cbiAgICBtb3Rvci5uYW1lID0gbmFtZSAjIGVpdGhlciAnTksxJyBvciAnTksyJ1xuICAgIG1vdG9yLmxvd2VyX2xpbWl0ID0gLTEwICMgbW0sIE5vdGU6IGxpbmVhciBhY3R1YXRvciBwaXRjaCBpcyAxbW0vcmV2LCAxMjggZW5jb2RlciBjb3VudHMgcGVyIHJldi5cbiAgICBtb3Rvci51cHBlcl9saW1pdCA9IDEwICMgbW1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyBtb3RvcixcbiAgICAgIHZhbHVlOlxuICAgICAgICBnZXQ6IC0+IFxuICAgICAgICAgIHN3aXRjaCBuYW1lXG4gICAgICAgICAgICB3aGVuICdOSzEnXG4gICAgICAgICAgICAgIHJldHVybiBAX3ZhbHVlID0gX3JvYm90LmdldE5LMSgpICMgSSB0aGluayB0aGlzIHdpbGwga2VlcCBldmVyeXRoaW5nIGluIHN5bmMuIDotL1xuICAgICAgICAgICAgd2hlbiAnTksyJyBcbiAgICAgICAgICAgICAgcmV0dXJuIEBfdmFsdWUgPSBfcm9ib3QuZ2V0TksyKClcbiAgICAgICAgc2V0OiAodmFsKSAtPlxuICAgICAgICAgIHZhbCA9IGNsYW1wKHZhbCx0aGlzKVxuICAgICAgICAgIEBfdmFsdWUgPSB2YWxcbiAgICAgICAgICBfcm9ib3QubW90b3JzLkhOUC52YWx1ZSA9IF9yb2JvdC5nZXRITlAoKVxuICAgICAgICAgIF9yb2JvdC5tb3RvcnMuSE5SLnZhbHVlID0gX3JvYm90LmdldEhOUigpXG4gICAgbW90b3IuZGVmYXVsdF92YWx1ZSA9IDAgI21tXG4gICAgbW90b3IuX3ZhbHVlID0gbW90b3IuZGVmYXVsdF92YWx1ZVxuICAgIEBtb3RvcnNbbmFtZV0gPSBtb3RvclxuICBhZGRGaW5nZXI6IChuYW1lKSAtPlxuICAgIF9yb2JvdCA9IHRoaXNcbiAgICAjIEFkZCBmaW5nZXIgbW90b3JcbiAgICBtb3RvciA9IHt9XG4gICAgbW90b3IubmFtZSA9IG5hbWVcbiAgICBtb3Rvci5sb3dlcl9saW1pdCA9IC0xXG4gICAgbW90b3IudXBwZXJfbGltaXQgPSAxXG4gICAgIyBOb3RlOiB3ZSBhcmUgVkVSWSBNVUNIIGV4cGVjdGluZyBhIFRMQSBmb3IgJ25hbWUnXG4gICAgaGFuZCA9IGlmIChuYW1lWzBdPT0nTCcpIHRoZW4gJ2xlZnQnIGVsc2UgJ3JpZ2h0J1xuICAgIGZpbmdlcnMgPSBbJ1RodW1iJywgJ0luZGV4JywgJ01pZGRsZScsICdSaW5nJywgJ1Bpbmt5J11cbiAgICBmaW5nZXIgPSBmaW5nZXJzW25hbWVbMl0tMV1cbiAgICBtb3Rvci5mdWxsX25hbWUgPSBoYW5kICsgZmluZ2VyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgbW90b3IsXG4gICAgICB2YWx1ZTpcbiAgICAgICAgZ2V0OiAtPiByZXR1cm4gQF92YWx1ZVxuICAgICAgICBzZXQ6ICh2YWwpIC0+IFxuICAgICAgICAgIHZhbCA9IGNsYW1wKHZhbCx0aGlzKVxuICAgICAgICAgIEBfdmFsdWUgPSB2YWwgIFxuICAgICAgICAgIHZhbCA9ICgtdmFsICsgMSkvMioxLjRcbiAgICAgICAgICBfcm9ib3Quam9pbnRzW0BmdWxsX25hbWUgKyAnS251Y2tsZTEnXS52YWx1ZSA9IHZhbFxuICAgICAgICAgIF9yb2JvdC5qb2ludHNbQGZ1bGxfbmFtZSArICdLbnVja2xlMiddLnZhbHVlID0gdmFsXG4gICAgICAgICAgX3JvYm90LmpvaW50c1tAZnVsbF9uYW1lICsgJ0tudWNrbGUzJ10udmFsdWUgPSB2YWxcbiAgICAgICAgICByZXR1cm5cbiAgICBtb3Rvci5kZWZhdWx0X3ZhbHVlID0gMC45ICMgc3RhcnQgd2l0aCBmaW5nZXJzIGhhbGYgY3VybGVkXG4gICAgbW90b3IudmFsdWUgPSBtb3Rvci5kZWZhdWx0X3ZhbHVlXG4gICAgIyBBZGQgdG8gbW90b3IgY29sbGVjdGlvblxuICAgIEBtb3RvcnNbbmFtZV0gPSBtb3RvclxuICAjIFRoZSBjb2RlIHVzZWQgdG8gZGVyaXZlIHRoZXNlIGVxdWF0aW9ucyBjYW4gYmUgZm91bmQgaW4gJ21pc2MvTmVja19zY2llbmNlJy5cbiAgIyBTaG9ydCBFeHBsYW5hdGlvbjogVGhlIG5lY2sgZm9yd2FyZCBraW5lbWF0aWNzIGhhcyBubyBzdHJhaWdodGZvcndhcmQgYW5hbHl0aWNhbCBzb2x1dGlvbi4gSW5zdGVhZCwgaXQgd2FzIHNvbHZlZCBudW1lcmljYWxseSBieVxuICAjIGZpeGluZyB0aGUgaGVhZCBwaXRjaCBhbmQgcm9sbCwgYW5kIHRoZW4gZmluZGluZyB0aGUgbGVuZ3RocyBvZiB0aGUgbGluZWFyIGFjdHVhdG9ycy4gKEVzc2VudGlhbGx5LCB0aGUgaW52ZXJzZSBraW5lbWF0aWNzIGFyZSBcbiAgIyBlYXNpZXIgdG8gc29sdmUuKSBVc2luZyB0aGlzLCBhIGJpZyBsb29rdXAgdGFibGUgd2FzIGNhbGN1bGF0ZWQuIFdoZW4gcGxvdHRlZCwgdGhlIHBpdGNoIGFuZCByb2xsIGZ1bmN0aW9ucyBjYW4gYmUgc2VlbiB0byBiZSBcbiAgIyBub24tbGluZWFyIGJ1dCB0aGV5IGFyZSBuZWFybHkgcGxhbmFyIDJEIGZ1bmN0aW9ucy4gVGhlIGVxdWF0aW9ucyB1c2VkIGJlbG93IGFyZSB0aGUgbGluZWFyIGJlc3QgZml0IG9mIHRoZSBudW1lcmljYWwgbG9va3VwIHRhYmxlcy5cbiAgIyBJdCBzaG91bGRuJ3QgYmUgb2ZmIGJ5IG1vcmUgdGhhbiBhIGNvdXBsZSBkZWdyZWVzIGF0IHdvcnN0LiAgXG4gIGdldE5LMTogKCkgLT5cbiAgICBITlAgPSBfcm9ib3QubW90b3JzLkhOUC52YWx1ZVxuICAgIEhOUiA9IF9yb2JvdC5tb3RvcnMuSE5SLnZhbHVlXG4gICAgcmV0dXJuIDE4MC9NYXRoLlBJKigwLjMyMjU4MSpITlAgLSAwLjM3ODg3NCpITlIpO1xuICBnZXROSzI6ICgpIC0+XG4gICAgSE5QID0gX3JvYm90Lm1vdG9ycy5ITlAudmFsdWVcbiAgICBITlIgPSBfcm9ib3QubW90b3JzLkhOUi52YWx1ZVxuICAgIHJldHVybiAxODAvTWF0aC5QSSooMC4zMjI1ODEqSE5QICsgMC4zNzg4NzQqSE5SKTtcbiAgZ2V0SE5QOiAoKSAtPlxuICAgIE5LMSA9IF9yb2JvdC5tb3RvcnMuTksxLl92YWx1ZVxuICAgIE5LMiA9IF9yb2JvdC5tb3RvcnMuTksyLl92YWx1ZVxuICAgIHJldHVybiBNYXRoLlBJLzE4MCooMS41NSpOSzEgKyAxLjU1Kk5LMilcbiAgZ2V0SE5SOiAoKSAtPlxuICAgIE5LMSA9IF9yb2JvdC5tb3RvcnMuTksxLl92YWx1ZVxuICAgIE5LMiA9IF9yb2JvdC5tb3RvcnMuTksyLl92YWx1ZVxuICAgIHJldHVybiBNYXRoLlBJLzE4MCooLTEuMzE5NypOSzEgKyAxLjMxOTcqTksyKVxuICByZXNldDogKCkgLT5cbiAgICBAbW90b3JzLmFzQXJyYXkoKS5mb3JFYWNoIChlKSAtPlxuICAgICAgZS52YWx1ZSA9IGUuZGVmYXVsdF92YWx1ZVxuICBvdXRwdXRQb3NlSGVhZGVyOiAoKSAtPlxuICAgIHJldHVybiAnUkhZICAgICAgICAgUkhSICAgICAgICAgUkhQICAgICAgICAgUktOICAgICAgICAgUkFQICAgICAgICAgUkFSICAgICAgICAgTEhZICAgICAgICAgTEhSICAgICAgICAgTEhQICAgICAgICAgTEtOICAgICAgICAgTEFQICAgICAgICAgTEFSICAgICAgICAgUlNQICAgICAgICAgUlNSICAgICAgICAgUlNZICAgICAgICAgUkVCICAgICAgICAgUldZICAgICAgICAgUldSICAgICAgICAgUldQICAgICAgICAgTFNQICAgICAgICAgTFNSICAgICAgICAgTFNZICAgICAgICAgTEVCICAgICAgICAgTFdZICAgICAgICAgTFdSICAgICAgICAgTFdQICAgICAgICAgTktZICAgICAgICAgTksxICAgICAgICAgTksyICAgICAgICAgV1NUICAgICAgICAgUkYxICAgICAgICAgUkYyICAgICAgICAgUkYzICAgICAgICAgUkY0ICAgICAgICAgUkY1ICAgICAgICAgTEYxICAgICAgICAgTEYyICAgICAgICAgTEYzICAgICAgICAgTEY0ICAgICAgICAgTEY1ICAgICAgICAgJ1xuICBvdXRwdXRQb3NlOiAoKSAtPlxuICAgIHN0ciA9ICcnXG4gICAgbmFtZXMgPSBAb3V0cHV0UG9zZUhlYWRlcigpLnRyaW0oKS5zcGxpdCggL1xcVysvIClcbiAgICBmb3IgbmFtZSBpbiBuYW1lc1xuICAgICAgaWYgaHViby5tb3RvcnNbbmFtZV0/ICAgICAgICBcbiAgICAgICAgdiA9IGh1Ym8ubW90b3JzW25hbWVdLnZhbHVlXG4gICAgICBlbHNlXG4gICAgICAgICMgV2UgbmVlZCB0byBzdXBwb3J0IGlnbm9yaW5nIGNvbHVtbnMgKHdyaXN0IHJvbGwsIHNwZWNpZmljYWxseSkgaW4gb3JkZXIgdG8gYmUgY29tcGF0aWJsZSBcbiAgICAgICAgIyB3aXRoIGh1Ym8tcmVhZC10cmFqZWN0b3J5XG4gICAgICAgIHYgPSAwICAgICAgIFxuICAgICAgdnN0ciA9IHYudG9GaXhlZCg2KVxuICAgICAgdnN0ciA9IChpZiB2Pj0wIHRoZW4gXCIrXCIgZWxzZSBcIlwiKSArIHZzdHJcbiAgICAgICMgaWYgdiA+PSAwIFxuICAgICAgIyAgIHZzdHIgPSBcIitcIiArIHZzdHJcbiAgICAgICMgZWxzZVxuICAgICAgIyAgIHZzdHIgPSBcIi1cIiArIHZzdHJcbiAgICAgIHZzdHIgPSBycGFkKHZzdHIsMTEsJyAnKSArICcgJ1xuICAgICAgc3RyICs9IHZzdHJcbiAgICByZXR1cm4gc3RyXG5cbmNsYW1wID0gKHZhbCxqb2ludCkgLT5cbiAgd2FybiA9IG9mZlxuICBpZiB2YWwgPCBqb2ludC5sb3dlcl9saW1pdFxuICAgIGlmIHdhcm4gdGhlbiBjb25zb2xlLndhcm4gam9pbnQubmFtZSArICcgdHJpZWQgdG8gdmlvbGF0ZSBsb3dlciBsaW1pdDogJyArIGpvaW50Lmxvd2VyX2xpbWl0XG4gICAgcmV0dXJuIGpvaW50Lmxvd2VyX2xpbWl0XG4gIGVsc2UgaWYgdmFsID4gam9pbnQudXBwZXJfbGltaXRcbiAgICBpZiB3YXJuIHRoZW4gY29uc29sZS53YXJuIGpvaW50Lm5hbWUgKyAnIHRyaWVkIHRvIHZpb2xhdGUgdXBwZXIgbGltaXQ6ICcgKyBqb2ludC51cHBlcl9saW1pdFxuICAgIHJldHVybiBqb2ludC51cHBlcl9saW1pdFxuICByZXR1cm4gdmFsXG5cblxubHBhZCA9IChvcmlnaW5hbHN0ciwgbGVuZ3RoLCBzdHJUb1BhZCkgLT5cbiAgICB3aGlsZSAob3JpZ2luYWxzdHIubGVuZ3RoIDwgbGVuZ3RoKVxuICAgICAgICBvcmlnaW5hbHN0ciA9IHN0clRvUGFkICsgb3JpZ2luYWxzdHJcbiAgICByZXR1cm4gb3JpZ2luYWxzdHJcblxuIFxucnBhZCA9IChvcmlnaW5hbHN0ciwgbGVuZ3RoLCBzdHJUb1BhZCkgLT5cbiAgICB3aGlsZSAob3JpZ2luYWxzdHIubGVuZ3RoIDwgbGVuZ3RoKVxuICAgICAgICBvcmlnaW5hbHN0ciA9IG9yaWdpbmFsc3RyICsgc3RyVG9QYWRcbiAgICByZXR1cm4gb3JpZ2luYWxzdHJcbiIKICBdCn0=